<!-- Debug Information (temporary) -->

<!-- Mobile Sidebar Backdrop -->
<div class="mobile-sidebar-backdrop" *ngIf="(isSidebarVisible$ | async) && mobileDrawerOpened" (click)="closeMobileSidebar()"></div>

<!-- Beautiful PrimeNG Mobile Sidebar -->
<div class="primeng-mobile-sidebar" *ngIf="(isSidebarVisible$ | async) && mobileDrawerOpened">
    <div class="mobile-nav-header">
    <h2>✨ServiceFuzz✨</h2>
      <p-button 
        icon="pi pi-times" 
        [text]="true" 
        [rounded]="true" 
        size="small"
        (onClick)="closeMobileSidebar()" 
        styleClass="close-button">
      </p-button>
    </div>
    
    <div class="mobile-nav-content">
      <!-- Main Navigation with PrimeNG Menu -->
      <p-menu [model]="mobileMenuItems" styleClass="mobile-menu"></p-menu>
      
      <!-- User Actions -->
      <div class="mobile-user-actions">
        <p-button 
          [label]="data.currentUser ? data.currentUser.name : 'Sign In'"
          icon="pi pi-user"
          [text]="true"
          routerLink="/sign"
          (onClick)="closeMobileSidebar()"
          styleClass="mobile-user-button">
        </p-button>
        
        <p-button 
          label="Notifications"
          icon="pi pi-bell"
          [text]="true"
          (onClick)="closeMobileSidebar()"
          styleClass="mobile-action-button">
        </p-button>
        
        <p-button 
          label="Settings"
          icon="pi pi-cog"
          [text]="true"
          routerLink="/settings"
          (onClick)="closeMobileSidebar()"
          styleClass="mobile-action-button">
        </p-button>
      </div>
    </div>
</div>

<!-- Beautiful PrimeNG Mobile Toolbar -->
<div class="primeng-mobile-toolbar" *ngIf="isSidebarVisible$ | async">
  <div class="toolbar-left">
    <p-button 
      icon="pi pi-bars" 
      [text]="true" 
      [rounded]="true" 
      size="small"
      (onClick)="toggleMobileSidebar()" 
      styleClass="hamburger-button">
    </p-button>
    <a class="app-title mobile-title">✨ServiceFuzz✨</a>
    <img src="/servicefuzz-logo.png" alt="ServiceFuzz logo" class="mobile-logo">
  </div>
  
  <div class="toolbar-right">
    <p-button 
      [icon]="data.currentUser ? '' : 'pi pi-user'"
      [text]="true" 
      [rounded]="true" 
      size="small"
      routerLink="/sign"
      [pTooltip]="data.currentUser ? data.currentUser.name : 'Sign In'">
      <p-avatar 
        *ngIf="data.currentUser" 
        [label]="getUserInitials()" 
        styleClass="user-avatar-mobile"
        shape="circle"
        size="normal">
      </p-avatar>
    </p-button>
  </div>
</div>

<!-- Desktop Toolbar with PrimeNG MegaMenu -->
<div class="primeng-desktop-toolbar" *ngIf="!(isSidebarVisible$ | async)">
  <div class="toolbar-left">
    <a class="app-title">✨ServiceFuzz✨</a>
    <img src="/Screenshot 2025-06-09 094337.svg" alt="ServiceFuzz logo" class="logo">
  </div>

  <!-- Beautiful Responsive Navigation -->
  <div class="toolbar-center">
    <nav class="main-navigation">
      <!-- Individual Menu Items with Responsive Behavior -->
      <p-button 
        *ngIf="!isItemHidden('home')"
        label="Home" 
        icon="pi pi-home"
        [text]="true"
        routerLink="/"
        routerLinkActive="active-nav-item"
        [routerLinkActiveOptions]="{exact: true}"
        styleClass="nav-item">
      </p-button>
      
      <p-button 
        *ngIf="!isItemHidden('analytics')"
        label="Analytics" 
        icon="pi pi-chart-line"
        [text]="true"
        routerLink="/analytics"
        routerLinkActive="active-nav-item"
        styleClass="nav-item">
      </p-button>
      
      <p-button 
        *ngIf="!isItemHidden('about')"
        label="About" 
        icon="pi pi-info-circle"
        [text]="true"
        routerLink="/about"
        routerLinkActive="active-nav-item"
        styleClass="nav-item">
      </p-button>
      
      <!-- Business Menu -->
      <p-menu #businessMenu [model]="businessMenuItems" [popup]="true" styleClass="business-dropdown-menu"></p-menu>
      <p-button 
        *ngIf="!isItemHidden('business')"
        label="Business" 
        icon="pi pi-building"
        [text]="true"
        (onClick)="businessMenu.toggle($event)"
        [class.active-nav-item]="isRouteActive('/business')"
        styleClass="nav-item">
      </p-button>
      
      <!-- Staff Menu -->
      <p-menu #staffMenu [model]="staffMenuItems" [popup]="true"></p-menu>
      <p-button 
        *ngIf="!isItemHidden('staff')"
        label="Staff" 
        icon="pi pi-users"
        [text]="true"
        (onClick)="staffMenu.toggle($event)"
        [class.active-nav-item]="isRouteActive('/staff')"
        styleClass="nav-item">
      </p-button>
      
      <!-- Universal Search Button -->
      <p-button 
        *ngIf="data.currentUser"
        icon="pi pi-search" 
        [text]="true"
        (onClick)="openUniversalSearch()"
        styleClass="nav-item search-button"
        pTooltip="Search everything (Ctrl+K)">
      </p-button>
      
      <!-- Overflow Menu (3-dot menu) -->
      <p-menu #overflowMenu [model]="overflowMenuItems" [popup]="true"></p-menu>
      <p-button 
        *ngIf="overflowItems.length > 0"
        icon="pi pi-ellipsis-h" 
        [text]="true"
        (onClick)="overflowMenu.toggle($event)"
        styleClass="nav-item overflow-menu-button"
        pTooltip="More options">
      </p-button>
    </nav>
  </div>
 
  <div class="toolbar-right">
    <!-- Subscription indicator -->
    <p-button 
      *ngIf="data.currentUser && subscriptionStatus" 
      (onClick)="navigateToBusinessSettings()" 
      [text]="true"
      [label]="isTrialing ? 'Trialing' : (isActiveSubscribedNoTrial ? 'Subscribed' : 'Subscribe')"
      [icon]="isTrialing ? 'pi pi-clock' : (isActiveSubscribedNoTrial ? 'pi pi-check-circle' : 'pi pi-exclamation-triangle')"
      [severity]="isTrialing ? 'secondary' : (isActiveSubscribedNoTrial ? 'success' : 'warn')"
      size="small">
    </p-button>
    
    <p-button 
      icon="pi pi-bell" 
      [text]="true" 
      [rounded]="true" 
      size="small"
      pTooltip="Notifications">
    </p-button>
    
    <p-button 
      icon="pi pi-cog" 
      [text]="true" 
      [rounded]="true" 
      size="small"
      routerLink="/settings"
      pTooltip="Settings">
    </p-button>
    
    <!-- User Avatar/Sign In -->
    <p-button 
      [icon]="data.currentUser ? '' : 'pi pi-user'"
      [text]="true" 
      [rounded]="true" 
      size="small"
      routerLink="/sign"
      [pTooltip]="data.currentUser ? data.currentUser.name : 'Sign In'">
      <p-avatar 
        *ngIf="data.currentUser" 
        [label]="getUserInitials()" 
        styleClass="user-avatar-primeng"
        shape="circle"
        size="normal">
      </p-avatar>
    </p-button>
  </div>
</div>